---
title: "Case Study: How Does a Bike-Share Navigate Speedy Success?"
author: "Laura Fontanills"
date: "`r format(Sys.time(), '%d %B %Y')`"
mail: "lfontanills@gmail.com"
linkedin: "lfontanills"
github: "lfontanills"
home: "lfontanills.github.io"
# !!! You need to provide a logo image here !!! Or just delete the field for no logo
# logo: "logo_gallery.png"
output:
  epuRate::epurate:
    toc: TRUE
    number_sections: FALSE
    code_folding: "hide"
---


<br><br>

<!-- > Let's start with a short introduction. Explain briefly what this document is going to talk about. May be add a [useful link](https://github.com/holtzy/epuRate) relative to this project. -->

> In this document I will import, clean, and analyze 12 months of bike-share user data. My task is to analyze ride data to determine how annual members and casual riders use the bike-share differently. This analysis will guide my recommendations for marketing strategy to convert casual riders into annual members. I completed this case study as part of my Google Data Analytics Certification. Check out the [full project repository](https://github.com/lfontanills/bikeshare-case-study) to see how I processed the 12 data sets and created a data frame ready for analysis.

# Get the data
***
<!-- Load libraries -->

```{r load libraries, message=FALSE, warning=FALSE}
library(tidyverse) # data processing and analysis
library(lubridate) # wrangle dates and times
library(kableExtra) # generate data tables
library(rmarkdown) # You need this library to run this template.
library(epuRate)  # Install with devtools: install_github("holtzy/epuRate", force=TRUE)
options(dplyr.summarise.inform = FALSE)
```

> The case study is about a fictional bike-share company called Cyclistic, while the data is taken from Chicago's Divvy bike-share, so in this report I will describe some considerations and assumptions I made to reconcile the case and the data set.

<!-- Comparison table: Cyclistic vs. Divvy and things to consider -->
```{r comparison_table}

comparison_table <- tibble(
  Item = c("Member types", "Bike types", "Docking", "Pricing"),
  Cyclistic = c("Member, Casual", "Classic, E-bike, Accessible bikes", "Must be docked", "Unspecified"),
  Divvy = c("Member, Casual", "Classic, E-Bike, Docked bike", "Docked, undocked with fees", "Flat rates with fees")
)

comparison_table %>% 
  kbl() %>% 
  kable_material(c("striped"))
```

> * Bike types: Since Cyclistic's accessible bikes account for 8% of riders, and Divvy does not have accessible bikes, I consider only classic and e-bikes in my analysis.
* Docking: Divvy docks use a different geolocation system than the bikes themselves-- docks have geolocation with 0.000001° sensitivity, while undocked bikes have geolocation with 0.01° sensitivity. Many Divvy docks are within 0.01° of other docks, especially in the city center where most rides take place, so undocked bikes can't reliably be matched with nearby docks. As Cyclistic bikes must all be docked, I am considering only bikes that start and end at docks in my analysis.

<!-- Then I explain what is my input data and I load it. Here is how it looks like: --> 

> My data for this project is located in 12 csvs, one for each of the last 12 months. I reviewed each month independently in Excel, which helped me uncover some issues to fix. These issues were:
* A test ride outside the Chicago area, and another few test rides with no geolocation
* Several rides starting before and ending after the DST time changes in March and November
* Many rides shorter than 1 minute, and longer than 24 hours
* Rides with no end location
* A nonspecific "docked" bike type assoiated with some rides by casual members
I decided to filter out these rides to better map my data to the Cyclistic case. 

```{r read df}
rides_all_clean <- read.csv("rides_all_clean.csv")
head(rides_all_clean)
```

This file has `r nrow(rides_all_clean)` lines and `r ncol(rides_all_clean)` columns. It is ready to be analyzed.

# Analysis
***
<!-- Here are 3 version of a [circular barplot](https://www.r-graph-gallery.com/circular-barplot/) that you can find in the [R graph gallery](https://www.r-graph-gallery.com/circular-barplot/). Note that the figure is centered. You can change the size of the plot with **fig.width** and **fig.height**   -->

> I focused on ride duration, ride frequency over different time periods, and classic vs. e-bike use. To see my analysis of these 3 areas, check out my github. 

> Casual riders and members differ in when they ride bikes, and how long they ride for. Casual riders also favor a few stations in the city center.

## Finding 1: Casual riders take more weekend trips
Member rides peak during the work week, which could indicate that many members use bikes for commuting. Casual rides peak on Saturday and Sunday, suggesting that casual riders use bikes for leisure or tourism.
```{r fig.align='center', warning=FALSE}
weekday_plot <-
  rides_all_clean %>% 
  mutate(weekday = wday(started_at, label = TRUE, abbr = FALSE)) %>% 
  group_by(member_casual, weekday) %>% 
  summarize(count=n()) %>% 
  ggplot(aes(x=weekday, y=count, fill=member_casual))+
  geom_col(position="dodge") +
  labs(
    title = "Number of rides by weekday",
    subtitle = "For all trips between 1 minute and 24 hours long",
    x = "User type", 
    y = "Number of rides",
    fill = "User type") +
  scale_y_continuous(labels = scales::comma) +
  theme_bw() + 
  scale_fill_brewer(palette = "Greens", direction = -1)

weekday_plot
```

## Finding 2: Casual riders take longer trips than members

Member rides, on average, take about 12 minutes, while casual rides last more than 20 minutes. Taken with finding 1, this indicates that many casual users are riding for fun.
```{r, warning=FALSE, fig.align='center' }
length_plot <-
rides_all_clean %>% 
  group_by(member_casual) %>% 
  summarize(number_of_rides = n(), mean_length = mean(ride_length)) %>% 
  arrange(member_casual) %>% 
  ggplot(aes(x=member_casual, y=mean_length, fill=member_casual)) +
  geom_col(position = "dodge") +
  labs(
    title = "Average ride duration",
    subtitle = "For all trips between 1 minute and 24 hours long",
    x = "User type", 
    y = "Average ride duration (seconds)",
    fill = "User type") +
  scale_x_discrete(labels = c("classic bike", "electric bike")) +
  scale_y_continuous(labels = scales::comma) +
  theme_bw() + 
  scale_fill_brewer(palette = "Greens", direction = -1)

length_plot
```

## Finding 3: Casual riders use a few stations relatively frequently

Casual riders show a clear preference for 5 stations in particular -- these stations make up about 8% of all casual rides (by starting point). Members don't especially favor a few stations, and no station accounts for more than 1% of all member rides (by starting point).
```{r, warning=FALSE, fig.align='center' }
rides_all_clean %>% 
  filter(member_casual == "casual") %>% 
  group_by(member_casual, start_station_name) %>% 
  summarize(count = n()) %>% 
  arrange(desc(count)) %>% 
  mutate(percent_of_rides = 100*(count/sum(count))) %>% 
  head(10)

rides_all_clean %>% 
  filter(member_casual == "member") %>% 
  group_by(member_casual, start_station_name) %>% 
  summarize(count = n()) %>% 
  arrange(desc(count)) %>% 
  mutate(percent_of_rides = 100*(count/sum(count))) %>% 
  head(10)
```
The top 5 casual starting stations are located in parks in the city center, close to the waterfront. These are very popular locations for tourists and locals.

# Conclusion
***
>  Here are my recommendations for converting casual riders to members:
* Market to non-commuter casual riders who use bikes for leisure
* Consider new membership options and pricing (e.g. weekend passes, adjusted pricing for longer trips)
* Increase advertising at high-traffic stations in the city center

<!-- add tableau viz to another section of site -->
<!-- consider a slides presentation later on -->


## Resources
***
[Data source](https://divvy-tripdata.s3.amazonaws.com/index.html)

[Data license](https://ride.divvybikes.com/data-license-agreement)

[City of Chicago Divvy database](https://data.cityofchicago.org/Transportation/Divvy-Bicycle-Stations-All-Map/bk89-9dk7)

<!-- Read more about this template [here](https://github.com/holtzy/epuRate). -->

<!-- Learn how to custom your R Markdown document [here](https://holtzy.github.io/Pimp-my-rmd/). -->
